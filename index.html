<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>APZN PRO</title>
    <link href="https://vjs.zencdn.net/7.20.3/video-js.css" rel="stylesheet" />
    <style>
        body { background: #000; color: white; font-family: 'Segoe UI', sans-serif; margin: 0; overflow: hidden; }
        .container { display: flex; flex-direction: column; height: 100vh; align-items: center; justify-content: center; }
        
        /* Login */
        .login-box { background: #111; padding: 40px; border-radius: 10px; border: 1px solid #333; text-align: center; }
        input { display: block; margin: 10px 0; padding: 12px; width: 280px; background: #222; border: 1px solid #444; color: white; border-radius: 5px; }
        button { width: 100%; padding: 12px; background: #fff; color: #000; border: none; font-weight: bold; cursor: pointer; border-radius: 5px; }

        /* Dashboard Estilo Smarters */
        #dashboard { display: none; width: 100%; height: 100vh; background: #050505; text-align: center; }
        .menu-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; padding: 50px; margin-top: 100px; }
        .menu-item { background: #111; border: 2px solid #333; padding: 40px; border-radius: 15px; cursor: pointer; transition: 0.3s; }
        .menu-item:hover { border-color: #fff; transform: scale(1.05); }
        .menu-item h2 { margin: 0; font-size: 24px; }

        /* Lista de Conteúdo */
        #content-list { display: none; width: 100%; height: 100vh; padding: 20px; overflow-y: auto; background: #000; }
        .item-row { padding: 10px; border-bottom: 1px solid #222; cursor: pointer; display: flex; align-items: center; }
        .item-row:hover { background: #111; }

        /* Player */
        #player-screen { display: none; width: 100%; height: 100vh; position: relative; }
        .btn-back { position: absolute; top: 20px; left: 20px; z-index: 100; background: rgba(255,255,255,0.2); width: auto; color: white; }
    </style>
</head>
<body>

    <div id="login-screen" class="container">
        <div class="login-box">
            <h1>APZN PRO</h1>
            <input type="text" id="user" placeholder="Usuário">
            <input type="password" id="pass" placeholder="Senha">
            <button onclick="login()">ENTRAR</button>
        </div>
    </div>

    <div id="dashboard">
        <h1 style="margin-top: 50px;">APZN PRO - Bem-vindo</h1>
        <div class="menu-grid">
            <div class="menu-item" onclick="loadContent('live')">
                <h2>CANAIS AO VIVO</h2>
            </div>
            <div class="menu-item" onclick="loadContent('vod')">
                <h2>FILMES</h2>
            </div>
            <div class="menu-item" onclick="loadContent('series')">
                <h2>SÉRIES</h2>
            </div>
        </div>
    </div>

    <div id="content-list">
        <button class="btn-back" onclick="showDashboard()">VOLTAR</button>
        <div id="list-container" style="margin-top: 60px;"></div>
    </div>

    <div id="player-screen">
        <button class="btn-back" onclick="closePlayer()">FECHAR</button>
        <video id="main-player" class="video-js vjs-default-skin" controls preload="auto" style="width: 100%; height: 100vh;"></video>
    </div>

    <script src="https://vjs.zencdn.net/7.20.3/video.min.js"></script>
    <script>
        const DNS = "http://midialink.cloud";
        let userData = { user: '', pass: '' };

        async function login() {
            userData.user = document.getElementById('user').value;
            userData.pass = document.getElementById('pass').value;

            // URL da API Xtream Codes para validar login
            const authUrl = `${DNS}/player_api.php?username=${userData.user}&password=${userData.pass}`;

            try {
                const response = await fetch(authUrl);
                const data = await response.json();

                if (data.user_info.auth === 1) {
                    document.getElementById('login-screen').style.display = 'none';
                    document.getElementById('dashboard').style.display = 'block';
                } else {
                    alert("Usuário ou Senha inválidos!");
                }
            } catch (e) {
                alert("Erro ao conectar ao servidor.");
            }
        }

        async function loadContent(type) {
            let action = type === 'live' ? 'get_live_streams' : (type === 'vod' ? 'get_vod_streams' : 'get_series');
            const url = `${DNS}/player_api.php?username=${userData.user}&password=${userData.pass}&action=${action}`;

            const res = await fetch(url);
            const data = await res.json();

            const container = document.getElementById('list-container');
            container.innerHTML = "";
            document.getElementById('dashboard').style.display = 'none';
            document.getElementById('content-list').style.display = 'block';

            data.forEach(item => {
                const div = document.createElement('div');
                div.className = 'item-row';
                div.innerHTML = `<span>${item.name || item.num}</span>`;
                div.onclick = () => playMedia(type, item.stream_id || item.series_id);
                container.appendChild(div);
            });
        }

        function playMedia(type, id) {
            let streamUrl;
            if(type === 'live') streamUrl = `${DNS}/live/${userData.user}/${userData.pass}/${id}.m3u8`;
            else if(type === 'vod') streamUrl = `${DNS}/movie/${userData.user}/${userData.pass}/${id}.mp4`;
            
            document.getElementById('content-list').style.display = 'none';
            document.getElementById('player-screen').style.display = 'block';

            const player = videojs('main-player');
            player.src({ src: streamUrl, type: type === 'live' ? 'application/x-mpegURL' : 'video/mp4' });
            player.play();
        }

        function showDashboard() {
            document.getElementById('content-list').style.display = 'none';
            document.getElementById('dashboard').style.display = 'block';
        }

        function closePlayer() {
            const player = videojs('main-player');
            player.pause();
            document.getElementById('player-screen').style.display = 'none';
            document.getElementById('dashboard').style.display = 'block';
        }
    </script>
</body>
</html>
